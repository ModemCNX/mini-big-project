#include <stdio.h>
#include <windows.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>

//variable that NOT gonna change by player ( system variable )
char version[] = "1.2.2";

int w=0,a=0,s=0,d=0,space=0; // user input flag

float eee=0; // for debug

LARGE_INTEGER frequency; // for game_time calculation
LARGE_INTEGER t1, t2; // for game_time calculation
float game_time = 0;
float delta_time = 0;

float select_choice_time = 0; // for select_choice delay
float space_time = 0; // for space_bar click delay

int current_text = -1; // to know what text index currently need to display // -1 = no text
int current_text_index = 0; // to know what index of text index currently need to display
float text_time = 0; // for text show delay
float text_appear_delay = 0.05; // x second per 1 char appear

// combat variable ( combat  mode variable )
int current_fight = 0;    // 0 = no fight   other number = fight index
int last_fight_result = 0;  // 0 = lost  1 = win
float combat_time = 0;
int combat_counter = 0;
float lose_time = 0;  // lose animation

typedef struct {
	float life_time;
    float x, y;
    float speed_x,speed_y;
    float accel_x,accel_y;
    float follow_player_time;
} enemy;

enemy enemy_container[1000];
int combat_screen[89][28];     // 0 none(and border) // >1 = enemy count
int combat_screen_change = 0;  // for update combat screen

int hp = 3;
int player_x = 0;
int player_y = 0;
float i_frame = 0;
float i_frame_time = 0.9;

float move_time_x = 0;
float move_time_y = 0;
float move_time_delay_x = 0.1;
float move_time_delay_y = 0.15;


//variable that gonna change ( VN mode variable )
int chapter = 0;
int subchapter = 0;
int select_choice = 1;


//image data

char test1[] = "1100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000100100100000000000000000000100100100000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100200100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000100100100000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000000000000100100100000000000100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000100100100000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100000000000000000000100100100100100100100100100100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100000000000100100100100100100000000000100100100100100100000000000100100100000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100000000000100100100100100100000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100100100100000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100000000000100100100100100100100100100100100100100100100100100100000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100000000000000000000000000000000000000100100100100100100100100100100100100000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100100100000000000000000000000000000100100100000000000100100100000000000000000000000000000000000000000000000100100100000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000100100100000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000100100100000000000100100100000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100000000000000000000000000000100100100100100100100100100000000000000000000000000000000000000000000000100100100000000000000000000100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100100150100000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000000000000100100100000000000000000000000000000000000000000000000000000000000000000000000000100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000100100100000000000000000000100100100000000000";

char test2[] = "2150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150000000000150150150000000000150150150150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000150150150000000000000000000150150150000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000150150150000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000150150150000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000150150150000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000150150150000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000150150150150150150000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150150150150150150150000000000150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000150150150150150150150150150150150150150150150000000000000000000150150150000000000150150150000000000150150150000000000150150150150150150150150150150150150";

//text data

char text_data[100][10000];
void make_text(){ // compatible with only ansi escape code that end with 'H' or 'm' only 
	strcpy (text_data[0],"\e[7;94H123456789012345678901234\e[8;94H123456789012345678901234\e[9;94H123456789012345678901234\e[10;94H123456789012345678901234\e[11;94H123456789012345678901234\e[12;94H123456789012345678901234\e[13;94H123456789012345678901234\e[14;94H123456789012345678901234\e[15;94H123456789012345678901234\e[16;94H123456789012345678901234\e[17;94H123456789012345678901234\e[18;94H123456789012345678901234\e[19;94H123456789012345678901234\e[20;94H123456789012345678901234");
	strcpy (text_data[1],"\e[7;94HTest text no.1\e[8;94Hpls dont type morethan24\e[9;94Hcharacter each line");
	strcpy (text_data[2],"\e[7;94HTest text no.2\e[8;94H\e[38;2;200;100;100mred text!\e[9;94H\e[0mback to normal color");
	strcpy (text_data[3],"\e[7;94HTest text no.3\e[8;94HDo you want to\e[9;94HTest fight mode?\e[23;94HYes :)\e[24;94HNo :(");
	strcpy (text_data[4],"\e[7;94Hyou win XD");
	strcpy (text_data[5],"\e[7;94Hyou lose xd");
}

// display function
void draw(char data[]){
	char draw_action[100000] = "";
	char text[100] = "";
	int draw_x = 0 , draw_y = 0 , draw_start_x = 1 , draw_start_y = 1;
	if(data[0] == '1'){ // draw full screen
		draw_x = 120;
		draw_y = 30;
		draw_start_x = 1;
		draw_start_y = 1;
	}else if(data[0] == '2'){ // draw VN picture
		draw_x = 89;
		draw_y = 28;
		draw_start_x = 2;
		draw_start_y = 2;
	}
	
	int index = 1;
	int i,j;
	for(i=0;i<draw_y;i++){
		sprintf(text,"\e[%d;%dH",draw_start_y + i,draw_start_x);
		strcat(draw_action,text);
		for(j=0;j<draw_x;j++){
			char pixel_data[9] = "";
			int data_rgb,data_r,data_g,data_b;
			strncpy(pixel_data , data + index , 9);
			index += 9;
			data_rgb = atoi(pixel_data);
			data_b = data_rgb % 1000;
			data_g = (data_rgb/1000) % 1000;
			data_r = (data_rgb/1000000) % 1000;	
			sprintf(text,"\e[48;2;%d;%d;%dm ",data_r,data_g,data_b);
			strcat(draw_action,text);
		}
	}
	printf("%s",draw_action);
}

void clear_text(){  //  clear current_text in screen by print char as ' '   
	if (current_text == -1){
		return;
	}
	int i;
	int ansi_code = 0;
	char draw_action[10000] = "";
	for(i=0;i<strlen(text_data[current_text]);i++){
		if (ansi_code == 0){
			if(text_data[current_text][i] == 27){
				draw_action[i] = 27;
				ansi_code = 1;
			}else{
				draw_action[i] = ' ';
			}
		}else{
			if(text_data[current_text][i] == 'H' || text_data[current_text][i] == 'm'){
				draw_action[i] = text_data[current_text][i];
				ansi_code = 0;
			}else{
				draw_action[i] = text_data[current_text][i];
			}
		}
	}
	
	printf("\e[0m%s",draw_action);
	
	current_text = -1;
	current_text_index = 0; 
	text_time = game_time;
}

void show_text(int text_index){          // call this function only once ****
	if (current_text == -1) {       // no text right now ok to draw
		current_text = text_index;
	}else{      // need to delete current text first bruh
		clear_text();
		current_text = text_index;
	}
}

void draw_text(){  // note:ascii   27 = /e(ESC code) 72 = H 109 = m
	if (current_text == -1){
		return;
	}
	if (current_text_index >= strlen(text_data[current_text])){  // already write all char
		return;
	}
	if (game_time < text_time) {   // still in text_appear_delay
		return;
	}
	text_time = game_time + text_appear_delay;
	int i;
	int ansi_code = 0;
	int ansi_length = 0;
	char draw_action[10000] = "";
	
	for(i=0;i<current_text_index;i++){        // add old text
		draw_action[i] = text_data[current_text][i];
	}
		
	for(i=current_text_index;i<strlen(text_data[current_text]);i++){    // add new text 1 only (and all ansi +1 if found escape code)
		if(text_data[current_text][i] == 0){     // end of string
			current_text_index += 1;
			break;
		}
		
		if (ansi_code == 0){
			if(text_data[current_text][i] == 27){
				draw_action[i] = 27;
				ansi_code = 1;
				ansi_length += 1;
				
			}else{
				draw_action[i] = text_data[current_text][i];
				current_text_index += 1;
				break;
			}
		}else{
			if(text_data[current_text][i] == 'H' || text_data[current_text][i] == 'm'){
				ansi_code = 0;
			}
			draw_action[i] = text_data[current_text][i];
			ansi_length += 1;
		}
		current_text_index += 1;
	}
	
	printf("\e[0m%s\e[0m",draw_action);
}

// update function

void update_input(){
	w = GetAsyncKeyState('W')!=0||GetAsyncKeyState(0x26)!=0?1:0;
	a = GetAsyncKeyState('A')!=0||GetAsyncKeyState(0x25)!=0?1:0;
	s = GetAsyncKeyState('S')!=0||GetAsyncKeyState(0x28)!=0?1:0;
	d = GetAsyncKeyState('D')!=0||GetAsyncKeyState(0x27)!=0?1:0;
	space = GetAsyncKeyState(0x20)!=0?1:0;
}


void update_game_time(float *game_time){
	QueryPerformanceCounter(&t2);
	delta_time = ((t2.QuadPart - t1.QuadPart) / (float)frequency.QuadPart)  - *game_time;
	*game_time = (t2.QuadPart - t1.QuadPart) / (float)frequency.QuadPart;
}

// function for check input ( not call every frame, need to call by code )

int check_select_choice(int choice_limit){    // return : if not change return 0 if change return old select_choice number
	float select_choice_delay = 0.2;
	if (w){
		if(select_choice > 1 && game_time > select_choice_time){
			select_choice_time = game_time + select_choice_delay;
			select_choice -= 1;
			return select_choice+1;
		}
	}else if (s){
		if(select_choice < choice_limit && game_time > select_choice_time){
			select_choice_time = game_time + select_choice_delay;
			select_choice += 1;
			return select_choice-1;
		}
	}
	return 0;
}

int check_space(){    // return : 1 if space press    0 if space not press ( or on cooldown )
	float space_delay = 0.3;
	if (space){
		if(game_time > space_time){
			space_time = game_time + space_delay;
			if (current_text_index < strlen(text_data[current_text]) && current_text != -1) {      // skip type time but not return 1
				current_text_index = strlen(text_data[current_text])-1 ;
				return 0;
			}
			return 1;
		}
	}
	return 0;
}

void update_game(){
	update_game_time(&game_time);
	update_input();
	draw_text();  // text system
}


void display_var(){              // for debug only
	printf("\e[48;2;0;0;0m");// change color of '' to r:g:b value	
	printf("\e[%d;%dH",1,1); // set cursor position (y,x)
	printf("[ version %s]",version);
	printf("[ game_time: %f delta_time: %f fps: %d ]",game_time,delta_time,(int)(1/delta_time));
	printf("\e[%d;%dH",2,92); // set cursor position (y,x)
	printf("[chapter:%d subchapter:%d ]",chapter,subchapter);
	printf("\e[%d;%dH",3,92); // set cursor position (y,x)
	printf("[f_result:%d cur_fight:%d ]",last_fight_result,current_fight);
	printf("\e[%d;%dH",4,92); // set cursor position (y,x)
	printf("[hp:%d x:%d y:%d]",hp,player_x,player_y);
	printf("\e[%d;%dH",5,92); // set cursor position (y,x)
	printf("[c_time:%.3f foe:%f]",combat_time,eee);
	printf("\e[%d;%dH",6,92); // set cursor position (y,x)
	printf("[c_counter:%d]",combat_counter);
	
	//printf("[ input w %d  a %d  s %d  d %d  m1 %d ]",w,a,s,d,m1);
}

// start funtion

void start_setup(){
	printf("\e[?25l"); // hide cursor
	SetConsoleOutputCP(CP_UTF8);      // for print emoji(player character in combat mode)
	QueryPerformanceFrequency(&frequency); // for update_game_time(){
	QueryPerformanceCounter(&t1);
	make_text();
}

//            game function

// combat function

void combat_screen_clear(){  // 89x28
	int i,j;
	for (i=0;i<28;i++){
		for (j=0;j<89;j++){
			combat_screen[j][i] = 0;
			combat_screen[j][i] = 0;
		}
	}
}

void take_damage(){
	i_frame = i_frame_time;
	hp -= 1;
	if(hp <= 0){
		lose_time = 3;
		combat_screen_clear();
	}
}

void draw_combat_full_screen(){
	char draw_combat_action[200000] = "";
	char text[1000] = "";
	char bg_dark_text[] = "\e[48;2;0;0;0m ";
	char bg_light_text[] = "\e[48;2;50;50;50m ";
	char enemy_text[] = "\e[48;2;200;200;200m ";
	int i,j;
	for (i=0;i<28;i++){
		sprintf(text,"\e[%d;%dH",2 + i,2);
		strcat(draw_combat_action,text);
		for (j=0;j<89;j++){
			if((combat_screen[j][i] <= 0)){ //nothing in bg
				if(hp > 0 && ( ((i==7||i==20) && (j>=20&&j<=68)) || ((j==20||j==68) && (i>=7&&i<=20)) )){    // make box
					strcat(draw_combat_action,bg_light_text);
				}else{
					strcat(draw_combat_action,bg_dark_text);
				}
			}else if(combat_screen[j][i] > 0){    //enemy in bg
				strcat(draw_combat_action,enemy_text);
			}
		}
	}
	
	if(player_x >= 0 && player_x <= 88 && player_y >= 0 && player_y <= 27){
		if(hp <= 0){
			if (lose_time < 2){
				sprintf(text,"\e[48;2;0;0;0m\e[%d;%dH\U0001f494\e[0m",player_y+2,player_x+2);
			}else{
				sprintf(text,"\e[48;2;0;0;0m\e[%d;%dH\u2764\e[0m",player_y+2,player_x+2);
			}
		}else if(i_frame > 0){
			if(combat_screen[player_x][player_y] > 0){   //enemy in bg
				sprintf(text,"\e[48;2;200;200;200m\e[38;2;255;0;0m\e[%d;%dH\u2661\e[0m",player_y+2,player_x+2);
			}else{
				sprintf(text,"\e[48;2;0;0;0m\e[38;2;255;0;0m\e[%d;%dH\u2661\e[0m",player_y+2,player_x+2);
			}
		}else{
			if(combat_screen[player_x][player_y] > 0){   //enemy in bg
				sprintf(text,"\e[48;2;200;200;200m\e[38;2;255;0;0m\e[%d;%dH\u2665\e[0m",player_y+2,player_x+2);
				take_damage();
			}else{
				sprintf(text,"\e[48;2;0;0;0m\e[38;2;255;0;0m\e[%d;%dH\u2665\e[0m",player_y+2,player_x+2);
			}
		}
		strcat(draw_combat_action,text);  // draw player 
	}
	printf("%s",draw_combat_action);
}

void start_fight(int fight_index){
	combat_screen_clear();
	current_fight = fight_index;
	combat_time = 0;
	combat_counter = 1;
	hp = 3;
	i_frame = 0;
	player_x = 44;
	player_y = 14;
}


void spawn(float life_time,float x,float y,float speed_x,float speed_y,float accel_x,float accel_y,float follow_player_time){
	int i;
	for(i=0;i<1000;i++){
		if(enemy_container[i].life_time <= 0){
			enemy_container[i].life_time = life_time;
			enemy_container[i].x = x;
			enemy_container[i].y = y;
			enemy_container[i].speed_x = speed_x;
			enemy_container[i].speed_y = speed_y;
			enemy_container[i].accel_x = accel_x;
			enemy_container[i].accel_y = accel_y;
			enemy_container[i].follow_player_time = follow_player_time;
			int x_int = (int)round(x);
			int y_int = (int)round(y);
			
			if ((x_int >= 0)&&(x_int<=88)&&(y_int >= 0)&&(y_int <= 27)){     // still in screen
				combat_screen[x_int][y_int] += 1;
			}
			
			break;
		}
	}
}

void update_enemy(){
	int i;
	for(i=0;i<1000;i++){
		if(enemy_container[i].life_time > 0 && enemy_container[i].life_time - delta_time <= 0){         // die this frame
			enemy_container[i].life_time -= delta_time;
			int x_int = (int)round(enemy_container[i].x);
			int y_int = (int)round(enemy_container[i].y);
			
			if ((x_int >= 0)&&(x_int<=88)&&(y_int >= 0)&&(y_int <= 27)){     // still in screen
				combat_screen[x_int][y_int] -=1;
			}
			
		}else if(enemy_container[i].life_time  - delta_time > 0 ){    // still alive (HUGE SUCCESS.)
			enemy_container[i].life_time -= delta_time;
			if(enemy_container[i].follow_player_time > 0){
				enemy_container[i].follow_player_time -= delta_time;
				float follow_x = (player_x - (enemy_container[i].x));
				float follow_y = (player_y - (enemy_container[i].y));
				float magnitude = sqrt((follow_x*follow_x)+(follow_y*follow_y));
				if(magnitude > 0 && magnitude < 10){
					follow_x = (follow_x/magnitude) *9;
					follow_y = (follow_y/magnitude) *7;
				}
				enemy_container[i].speed_x = follow_x;
				enemy_container[i].speed_y = follow_y;
			}
			enemy_container[i].speed_x += enemy_container[i].accel_x*delta_time;
			enemy_container[i].speed_y += enemy_container[i].accel_y*delta_time;
			int x_int = (int)round(enemy_container[i].x);
			int y_int = (int)round(enemy_container[i].y);
			int new_x_int = (int)round(enemy_container[i].x+(enemy_container[i].speed_x*delta_time));
			int new_y_int = (int)round(enemy_container[i].y+(enemy_container[i].speed_y*delta_time));
			if ((x_int != new_x_int) || (y_int != new_y_int)){  // move in screen 
				if ((x_int >= 0)&&(x_int<=88)&&(y_int >= 0)&&(y_int <= 27)){     // still in screen
					combat_screen[x_int][y_int] -= 1;
				}
				if ((new_x_int >= 0)&&(new_x_int<=88)&&(new_y_int >= 0)&&(new_y_int <= 27)){  // still in screen
					combat_screen[new_x_int][new_y_int] += 1;
				}
			}
			enemy_container[i].x += (enemy_container[i].speed_x*delta_time);
			enemy_container[i].y += (enemy_container[i].speed_y*delta_time);
		}
	}
}

void lose(){
	if(lose_time > 0){
		lose_time -= delta_time;
	}else{
		last_fight_result = 0;
		current_fight = 0;
		printf("\e[23;94H   ");// clear heart ui
	}
}

void win(){
	last_fight_result = 1;
	current_fight = 0;
	printf("\e[23;94H   ");// clear heart ui
}

void move(){   
	int new_x = player_x;
	int new_y = player_y;
	
	if(w||s){
		if(game_time > move_time_y){
			move_time_y = game_time + move_time_delay_y;
			if(w)new_y -= 1;
			if(s)new_y += 1;
		}
	}
	if(a||d){
		if(game_time > move_time_x){
			move_time_x = game_time + move_time_delay_x;
			if(a)new_x -= 1;
			if(d)new_x += 1;
		}
	}
	
	if(new_x <= 20 || new_x >= 68 || new_y <= 7 || new_y >= 20) return;
	if((new_x == player_x)&&(new_y == player_y)) return; // not move
	
	player_x = new_x;
	player_y = new_y;
}
	
void draw_heart_ui(){
	printf("\e[48;2;0;0;0m\e[38;2;255;0;0m\e[23;94H");
	int i;
	for(i=1;i<=3;i++){
		if(hp >= i){
			printf("\u2665");
		}else{
			printf("\u2661");
		}
	}
	printf("\e[0m");
}

void combat_progress(){ 
	combat_time += delta_time;
	draw_combat_full_screen();
	draw_heart_ui();
	if(hp <= 0){
		lose();
		return;
	}
	if(i_frame > 0){
		i_frame -= delta_time;
	}	
	
	update_enemy();
	move();
	
	if(current_fight == 1){  // villager force lose   < 40 sec
		if(combat_counter == 1 && combat_time >= 2){
			combat_counter ++;
			int i;
			for(i=0;i<6;i++){
				spawn(10,88,8+i,0,0,-10,0,0);
			}
		}else if(combat_counter == 2 && combat_time >= 3){
			combat_counter ++;
			int i;
			for(i=0;i<6;i++){
				spawn(10,0,14+i,0,0,10,0,0);
			}
		}else if(combat_counter == 3 && combat_time >= 6){
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){     //  5 sec down
				spawn(15,26+i,0,0,7,0,-1.3,0);
				spawn(15,45+i,0,0,7,0,-1.3,0);
				spawn(15,26+i,-10,0,7,0,-1.3,0);
				spawn(15,45+i,-10,0,7,0,-1.3,0);
			}
			for(i=0;i<9;i++){     //  5 sec down
				spawn(15,26,-1-i,0,7,0,-1.3,0);
				spawn(15,43,-1-i,0,7,0,-1.3,0);
				spawn(15,45,-1-i,0,7,0,-1.3,0);
				spawn(15,62,-1-i,0,7,0,-1.3,0);
			}
			
		}else if(combat_counter == 4 && combat_time >= 17){
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){     //  5 sec down
				spawn(5,26+i,0,0,7,0,-1.3,0);
				spawn(5,45+i,0,0,7,0,-1.3,0);
				spawn(5,26+i,-10,0,7,0,-1.3,0);
				spawn(5,45+i,-10,0,7,0,-1.3,0);
			}
			for(i=0;i<9;i++){     //  5 sec down
				spawn(5,26,-1-i,0,7,0,-1.3,0);
				spawn(5,43,-1-i,0,7,0,-1.3,0);
				spawn(5,45,-1-i,0,7,0,-1.3,0);
				spawn(5,62,-1-i,0,7,0,-1.3,0);
			}
		}else if(combat_counter == 5 && combat_time >= 22){
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){     //  5 sec down
				spawn(15,26+i,9,-2,0,-3,0,0);
				spawn(15,45+i,9,2,0,3,0,0);
				spawn(15,26+i,19,-2,0,-3,0,0);
				spawn(15,45+i,19,2,0,3,0,0);
			}
			for(i=0;i<9;i++){     //  5 sec down
				spawn(15,26,10+i,-2,0,-3,0,0);
				spawn(15,43,10+i,-2,0,-3,0,0);
				spawn(15,45,10+i,2,0,3,0,0);
				spawn(15,62,10+i,2,0,3,0,0);
			}
		}else if(combat_counter == 6 && combat_time >= 28){
			combat_counter ++;
			int i;
			for(i=0;i<12;i++){
				spawn(10,0,8+i,5,0,10,0,0);
			}
		}else if(combat_counter == 7 && combat_time >= 30){
			combat_counter ++;
			int i;
			for(i=0;i<12;i++){
				spawn(10,0,8+i,5,0,10,0,0);
			}
		}else if(combat_counter == 8 && combat_time >= 32){
			combat_counter ++;
			int i;
			for(i=0;i<12;i++){
				spawn(10,0,8+i,5,0,10,0,0);
			}
		}else if(combat_counter == 9 && combat_time >= 40){
			combat_counter ++;
			hp = 0;
			take_damage();
		}
	}else if(current_fight == 2){  // villager can win 28 sec
		if(combat_counter == 1 && combat_time >= 2){
			combat_counter ++;
			int i;
			for(i=0;i<6;i++){
				spawn(10,88,8+i,0,0,-10,0,0);
			}
		}else if(combat_counter == 2 && combat_time >= 3){
			combat_counter ++;
			int i;
			for(i=0;i<6;i++){
				spawn(10,0,14+i,0,0,10,0,0);
			}
		}else if(combat_counter == 3 && combat_time >= 6){
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){     //  5 sec down
				spawn(15,26+i,0,0,7,0,-1.3,0);
				spawn(15,45+i,0,0,7,0,-1.3,0);
				spawn(15,26+i,-10,0,7,0,-1.3,0);
				spawn(15,45+i,-10,0,7,0,-1.3,0);
			}
			for(i=0;i<9;i++){     //  5 sec down
				spawn(15,26,-1-i,0,7,0,-1.3,0);
				spawn(15,43,-1-i,0,7,0,-1.3,0);
				spawn(15,45,-1-i,0,7,0,-1.3,0);
				spawn(15,62,-1-i,0,7,0,-1.3,0);
			}
			
		}else if(combat_counter == 4 && combat_time >= 17){
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){     //  5 sec down
				spawn(5,26+i,0,0,7,0,-1.3,0);
				spawn(5,45+i,0,0,7,0,-1.3,0);
				spawn(5,26+i,-10,0,7,0,-1.3,0);
				spawn(5,45+i,-10,0,7,0,-1.3,0);
			}
			for(i=0;i<9;i++){     //  5 sec down
				spawn(5,26,-1-i,0,7,0,-1.3,0);
				spawn(5,43,-1-i,0,7,0,-1.3,0);
				spawn(5,45,-1-i,0,7,0,-1.3,0);
				spawn(5,62,-1-i,0,7,0,-1.3,0);
			}
		}else if(combat_counter == 5 && combat_time >= 22){
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){     //  5 sec down
				spawn(15,26+i,9,-2,0,-3,0,0);
				spawn(15,45+i,9,2,0,3,0,0);
				spawn(15,26+i,19,-2,0,-3,0,0);
				spawn(15,45+i,19,2,0,3,0,0);
			}
			for(i=0;i<9;i++){     //  5 sec down
				spawn(15,26,10+i,-2,0,-3,0,0);
				spawn(15,43,10+i,-2,0,-3,0,0);
				spawn(15,45,10+i,2,0,3,0,0);
				spawn(15,62,10+i,2,0,3,0,0);
			}
		}else if(combat_counter == 6 && combat_time >= 28){
			combat_counter ++;
			win();
		}
	}else if(current_fight == 3){  // bear  28 sec
		if(combat_counter == 1 && combat_time >= 1){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				spawn(10,15+i,6-i,-7,-7,10,10,0);
				spawn(10,69+i,2+i,7,-7,-10,10,0);
			}
		}else if(combat_counter == 2 && combat_time >= 3){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,21+i,1,0,-3,0,5,0); else spawn(10,21+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 3 && combat_time >= 3.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,27+i,1,0,-3,0,5,0); else spawn(10,27+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 4 && combat_time >= 4){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,33+i,1,0,-3,0,5,0); else spawn(10,33+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 5 && combat_time >= 4.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,39+i,1,0,-3,0,5,0); else spawn(10,39+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 6 && combat_time >= 5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,45+i,1,0,-3,0,5,0); else spawn(10,45+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 7 && combat_time >= 5.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,51+i,1,0,-3,0,5,0); else spawn(10,51+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 8 && combat_time >= 6){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,57+i,1,0,-3,0,5,0); else spawn(10,57+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 9 && combat_time >= 6.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,63+i,1,0,-3,0,5,0); else spawn(10,63+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 10 && combat_time >= 7){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,57+i,1,0,-3,0,5,0); else spawn(10,57+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 11 && combat_time >= 8){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,51+i,1,0,-3,0,5,0); else spawn(10,51+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 12 && combat_time >= 8.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,45+i,1,0,-3,0,5,0); else spawn(10,45+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 13 && combat_time >= 9){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,39+i,1,0,-3,0,5,0); else spawn(10,39+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 14 && combat_time >= 9.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,33+i,1,0,-3,0,5,0); else spawn(10,33+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 15 && combat_time >= 10){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,27+i,1,0,-3,0,5,0); else spawn(10,27+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 16 && combat_time >= 10.5){
			combat_counter ++;
			int i;
			for(i=0;i<5;i++){
				if(i%2 == 0) spawn(10,21+i,1,0,-3,0,5,0); else spawn(10,21+i,0,0,-3,0,5,0);
			}
		}else if(combat_counter == 17 && combat_time >= 14){
			combat_counter ++;
			int i;
			for(i=0;i<6;i++){
				spawn(10,88,8+i,0,0,-10,0,0);
				spawn(10,0,14+i,0,0,10,0,0);
				if (i<5){
					spawn(10,15+i,6-i,-7,-7,10,10,0);
					spawn(10,69+i,2+i,7,-7,-10,10,0);
				}
			}
		}else if(combat_counter == 18 && combat_time >= 18){
			combat_counter ++;
			int i;
			for(i=0;i<47;i++){
				spawn(10,21+i,0,0,10,0,-2.8,0);
			}
		}else if(combat_counter == 19 && combat_time >= 22){
			combat_counter ++;
			int i;
			for(i=0;i<11;i++){
				spawn(10,3,9+i,-11,0,20+(i*0.5),0,0);
			}
		}else if(combat_counter == 20 && combat_time >= 28){
			combat_counter ++;
			win();
		}
	}else if(current_fight == 4){  // GOON   52 sec
		if(combat_counter == 1 && combat_time >= 1){  // follow
			combat_counter ++;
			spawn(10,86,8,0,0,0,0,5); 
		}else if(combat_counter == 2 && combat_time >= 1.5){ 
			combat_counter ++;
			spawn(10,0,19,0,0,0,0,5); 
		}else if(combat_counter == 3 && combat_time >= 6){ 
			combat_counter ++;
			spawn(10,0,19,0,0,0,0,5); 
		}else if(combat_counter == 4 && combat_time >= 6.5){ 
			combat_counter ++;
			spawn(10,86,8,0,0,0,0,5); 
		}else if(combat_counter == 5 && combat_time >= 7){ 
			combat_counter ++;
			spawn(10,0,19,0,0,0,0,5); 
		}else if(combat_counter == 6 && combat_time >= 15){ 
			combat_counter ++;
			int i;
			for(i=0;i<47;i++){
				if (i%2 == 0){      // top      
					spawn(30,21+i,-(i*25),0,100,0,0,0);
				}else{              // bottom
					spawn(30,21+i,27+i*25,0,-100,0,0,0);
				}
			}
		}else if(combat_counter == 7 && combat_time >= 28){  // 3bullet & follow
			combat_counter ++;
			int i,j;
			spawn(10,0,8,0,0,0,0,5); 
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(1.35,88+j,8+i,-50,0,0,0,0);
					spawn(1.35,98+j,10+i,-50,0,0,0,0);
					spawn(1.35,108+j,12+i,-50,0,0,0,0);
				}
			}
		}else if(combat_counter == 8 && combat_time >= 29.35){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(5,21+j,8+i,0,0,0,20,0);
					spawn(5,31+j,10+i,0,0,0,20,0);
					spawn(0.8,41+j,12+i,0,0,0,20,0);
				}
			}
		}else if(combat_counter == 9 && combat_time >= 30.15){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(5,41+j,18+i,0,0,20,0,0);
				}
			}
		}else if(combat_counter == 10 && combat_time >= 33){  // 3bullet & follow  flip
			combat_counter ++;
			int i,j;
			spawn(10,88,20,0,0,0,0,5); 
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(1.35,0+j,18+i,50,0,0,0,0);
					spawn(1.35,-10+j,16+i,50,0,0,0,0);
					spawn(1.35,-20+j,14+i,50,0,0,0,0);
				}
			}
		}else if(combat_counter == 11 && combat_time >= 34.35){
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(5,66+j,18+i,0,0,0,-20,0);
					spawn(5,56+j,16+i,0,0,0,-20,0);
					spawn(0.8,46+j,14+i,0,0,0,-20,0);
				}
			}
		}else if(combat_counter == 12 && combat_time >= 35.15){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(5,46+j,8+i,0,0,-20,0,0);
				}
			}
		}else if(combat_counter == 13 && combat_time >= 38){ 
			combat_counter ++;
			int i;
			for(i=0;i<47;i++){
				if (i%2 == 0){      // top      
					spawn(30,21+i,-((47-i)*25),0,100,0,0,0);
				}else{              // bottom
					spawn(30,21+i,27+(47-i)*25,0,-100,0,0,0);
				}
			}
		}else if(combat_counter == 14 && combat_time >= 52){ 
			combat_counter ++;
			win();
		}
		
	}else if(current_fight == 5){  // vamp   60 sec
	if(combat_counter == 1 && combat_time >= 1){  
			combat_counter ++;
			int i;
			for(i=0;i<12;i++){   
				spawn(5.4,88,8+i,-25.8,0,5,0,0);
			}	
		}else if(combat_counter == 2 && combat_time >= 6.4){ 
			combat_counter ++;
			int i;
			for(i=0;i<12;i++){   
				spawn(20,22,8+i,3.7,0,0,0,0);
			}	
		}else if(combat_counter == 3 && combat_time >= 8){ 
			combat_counter ++;
			int i;
			for(i=0;i<47;i++){
				if (i%2 == 0){      // top      
					spawn(20,21+i,-(i*25),0,100,0,0,0);
				}else{              // bottom
					spawn(20,21+i,27+i*25,0,-100,0,0,0);
				}
			}	
		}else if(combat_counter == 4 && combat_time >= 25){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(1.6,88+j,13+i,-70,0,35,0,0);
				}
			}
		}else if(combat_counter == 5 && combat_time >= 26.6){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<5;i++){
				for(j=0;j<2;j++){
					spawn(0.5,21+j,14,0,2+i*2,0,0,0);
					spawn(0.5,21+j,13,0,-2-i*2,0,0,0);
				}
			}
		}else if(combat_counter == 6 && combat_time >= 27.1){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<5;i++){
				for(j=0;j<2;j++){
					spawn(5,21+j,8+i,0,0,40,0,0);
					spawn(5,21+j,15+i,0,0,40,0,0);
				}
			}
		}else if(combat_counter == 7 && combat_time >= 30){   // bats
			combat_counter ++;
			int i;  
			for(i=0;i<5;i++){
				if(i%2 == 0){
					spawn(10,37+i/2,-8+i/2,-20,20,0,0,0);
					spawn(10,43+i/2,-4+i/2,-20,20,0,0,0);
					spawn(10,56+i/2,-7+i/2,-20,20,0,0,0);
					spawn(10,71+i/2,-12+i/2,-20,20,0,0,0);
					spawn(10,78+i/2,-9+i/2,-20,20,0,0,0);
					spawn(10,91+i/2,-12+i/2,-20,20,0,0,0);
				}else{
					spawn(10,38+i/2,-8+i/2,-20,20,0,0,0);
					spawn(10,44+i/2,-4+i/2,-20,20,0,0,0);
					spawn(10,57+i/2,-7+i/2,-20,20,0,0,0);
					spawn(10,72+i/2,-12+i/2,-20,20,0,0,0);
					spawn(10,79+i/2,-9+i/2,-20,20,0,0,0);
					spawn(10,92+i/2,-12+i/2,-20,20,0,0,0);
				}
			}
			
		}else if(combat_counter == 8 && combat_time >= 33){   // up crush + 4 half wall
			combat_counter ++;
			int i;
			for(i=0;i<47;i++){
				spawn(1.9,21+i,0,0,0,0,10,0);
			}
		}else if(combat_counter == 9 && combat_time >= 34.9){ 
			combat_counter ++;
			int i;
			for(i=0;i<47;i++){
				spawn(1.9,21+i,18,0,0,0,-10,0);
			}
		}else if(combat_counter == 10 && combat_time >= 36){
			combat_counter ++;
			int i;
			for(i=0;i<6;i++){
				spawn(5,88,8+i,0,0,-30,0,0);
				spawn(5,0,14+i,0,0,30,0,0);
			}
		}else if(combat_counter == 11 && combat_time >= 39){
			combat_counter ++;
			int i;
			for(i=0;i<24;i++){
				spawn(5,21+i,27,0,0,0,-10,0);
			}
			for(i=0;i<24;i++){
				spawn(5,44+i,0,0,0,0,10,0);
			}
		}else if(combat_counter == 12 && combat_time >= 43){  //foot
		combat_counter ++;
			int i;
			for(i=0;i<18;i++){     
				spawn(1.95,26+i,0,0,0,0,10,0);
				spawn(1.95,45+i,0,0,0,0,10,0);
				spawn(1.95,26+i,-10,0,0,0,10,0);
				spawn(1.95,45+i,-10,0,0,0,10,0);
			}
			for(i=0;i<9;i++){   
				spawn(1.95,26,-1-i,0,0,0,10,0);
				spawn(1.95,43,-1-i,0,0,0,10,0);
				spawn(1.95,45,-1-i,0,0,0,10,0);
				spawn(1.95,62,-1-i,0,0,0,10,0);
			}
		}else if(combat_counter == 13 && combat_time >= 44.95){   // wait around 5 sec
			combat_counter ++;
			int i;
			for(i=0;i<18;i++){ 
				spawn(15,26+i,9,-2,0,-3,0,0);
				spawn(15,45+i,9,2,0,3,0,0);
				spawn(15,26+i,19,-2,0,-3,0,0);
				spawn(15,45+i,19,2,0,3,0,0);
			}
			for(i=0;i<9;i++){  
				spawn(15,26,10+i,-2,0,-3,0,0);
				spawn(15,43,10+i,-2,0,-3,0,0);
				spawn(15,45,10+i,2,0,3,0,0);
				spawn(15,62,10+i,2,0,3,0,0);
			}	
			
			
		}else if(combat_counter == 14 && combat_time >= 50){   // cyclone of hell (for programmer)
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(0.67,0+j,8+i,100,0,0,0,0);
					spawn(0.67,87+j,18+i,-100,0,0,0,0);
				}
			}
		}else if(combat_counter == 15 && combat_time >= 50.67){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(0.08,66+j,8+i,0,100,0,0,0);
					spawn(0.08,21+j,18+i,0,-100,0,0,0);
				}
			}
		}else if(combat_counter == 16 && combat_time >= 50.75){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(0.42,66+j,16+i,-100,0,0,0,0);
					spawn(0.42,21+j,10+i,100,0,0,0,0);
				}
			}
		}else if(combat_counter == 17 && combat_time >= 51.17){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(0.03,23+j,16+i,0,-100,0,0,0);
					spawn(0.03,63+j,10+i,0,100,0,0,0);
				}
			}
		}else if(combat_counter == 18 && combat_time >= 51.2){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(0.55,23+j,13+i,-30,0,250,0,0);
					spawn(0.55,63+j,13+i,30,0,-250,0,0);
				}
			}
		}else if(combat_counter == 19 && combat_time >= 51.75){   // wait & expand
			combat_counter ++;
			int i,j;
			for(i=0;i<2;i++){
				for(j=0;j<2;j++){
					spawn(2.5,43+j,13+i,0,0,0,0,0);
					spawn(2.5,44+j,13+i,0,0,0,0,0);
				}
			}
		}else if(combat_counter == 20 && combat_time >= 54.25){ 
			combat_counter ++;
			int i,j;
			for(i=0;i<12;i++){
				spawn(0.5,43,13+i/6,35,-10+i*1.8,0,0,0);
				spawn(0.5,45,13+i/6,-35,-10+i*1.8,0,0,0);
			}
			for(i=0;i<31;i++){
				spawn(0.5,43+i/16.5,13,-30+i*2,-11,0,0,0);
				spawn(0.5,43+i/16.5,14,-30+i*2,11,0,0,0);
			}
		}else if(combat_counter == 21 && combat_time >= 60){ 
			combat_counter ++;
			win();
		}
	}
}

// VN function
void clear_chapter_data(){
	subchapter = 0;
	select_choice = 1;
	select_choice_time = 0;
}

void change_chapter(int target_chapter){
	clear_chapter_data();
	chapter = target_chapter;
}


void chapter_0(){
	if (subchapter == 0){
		subchapter = 1;
		printf("\e[%d;%dH",14,10); // set cursor position (y,x)
		printf("\e[3m\e[1mHello Welcome\e[0m");
		printf("\e[%d;%dH",15,12); // set cursor position (y,x)
		printf("\e[2m\e[1mstart\e[0m");
		printf("\e[%d;%dH",16,12); // set cursor position (y,x)
		printf("\e[2m\e[1mchapter teleport\e[0m");
		
		printf("\e[%d;%dH",15,10); // set cursor position (y,x)
		printf(">");
	}
	int old_choice = check_select_choice(2);
	if (old_choice){
		printf("\e[%d;%dH",14+old_choice,10); // set cursor position (y,x)
		printf(" ");
		printf("\e[%d;%dH",14+select_choice,10); // set cursor position (y,x)
		printf(">");
	}
	if (check_space()){
		if (select_choice == 1){
			change_chapter(1);
		}
	}
}


void chapter_1(){
	if (subchapter == 0){
		draw(test1);   // Full screen picture
		draw(test2);   // VN picture
		show_text(3);
		subchapter = 3;
		printf("\e[48;2;0;0;0m ");// change color of ' ' to r:g:b value
		printf("\e[%d;%dH",23,93); // set cursor position (y,x)
		printf(">");
	}else if (subchapter == 3){
		int old_choice = check_select_choice(2);
		if (old_choice){
			printf("\e[%d;%dH",22+old_choice,93); // set cursor position (y,x)
			printf(" ");
			printf("\e[%d;%dH",22+select_choice,93); // set cursor position (y,x)
			printf(">");
		}
		
		if(check_space()){
			printf("\e[%d;%dH",22+select_choice,93); // set cursor position (y,x)
			printf(" ");
			if(select_choice == 1){
				subchapter = 4;
				clear_text();
				start_fight(5);    // enter combat mode
			}else if(select_choice == 2){
				subchapter = 5;
				show_text(0);
			}
		}
	}
	else if (subchapter == 4){
		draw(test2);   // VN picture
		if(last_fight_result == 1){     // win
			subchapter = 7;
			show_text(4);
		}else if(last_fight_result == 0){     // lose
			subchapter = 8;
			show_text(5);
		}
	}else if (subchapter == 5){
		if(check_space()){
			subchapter = 6;
		}
	}
}

void game_progress(){    // call every tick
	if (current_fight != 0){
		combat_progress();
	}else if (chapter == 0){
		chapter_0();
	}else if (chapter == 1){
		chapter_1();
	}
}

//main bruh
void main(){
	start_setup();
	while (1){ // game loop
		update_game();
		display_var();  // for debug only
		game_progress();
	}
	// end game
}

// note
/*
printf("\e[1;1H\e[2J"); // clear screen
printf("\e[1;1H\e[2J\e[1;1H\e[3J"); // clear screen & clear scroll up
printf("\e[%d;%dH",1,1); // set cursor position (y,x)
printf("\e[48;2;%d;%d;%dm ",0,0,0);// change color of ' ' to r:g:b value
*/

